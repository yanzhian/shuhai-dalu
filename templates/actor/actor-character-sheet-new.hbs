<form class="{{cssClass}} dark-theme flexcol" autocomplete="off">
  {{!-- æ•´åˆçš„è§’è‰²ä¿¡æ¯é¢æ¿ --}}
  <div class="character-panel">
    {{!-- å·¦ä¾§ï¼šè§’è‰²å›¾åƒå’ŒåŸºç¡€ä¿¡æ¯ --}}
    <div class="left-section">
      <div class="profile-container">
        <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{actor.name}}"/>
        <div class="level-badge">Lv.{{system.level}}</div>
      </div>
      
      <div class="character-info">
        <h1 class="charname">
          <input name="name" type="text" value="{{actor.name}}" placeholder="è§’è‰²åç§°"/>
        </h1>
        
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">ç§æ—</span>
            <input type="text" name="system.info.race" value="{{system.info.race}}" placeholder="äººç±»"/>
          </div>
          <div class="info-item">
            <span class="info-label">æ€§åˆ«</span>
            <input type="text" name="system.info.gender" value="{{system.info.gender}}" placeholder="æœªçŸ¥"/>
          </div>
          <div class="info-item">
            <span class="info-label">åŠ¿åŠ›</span>
            <input type="text" name="system.info.faction" value="{{system.info.faction}}" placeholder="æ— "/>
          </div>
          <div class="info-item full-width">
            <span class="info-label">ç»éªŒå€¼</span>
            <div class="exp-bar">
              <input type="number" name="system.info.experience" value="{{system.info.experience}}" min="0"/>
              <span class="exp-max">/2700</span>
              <div class="exp-progress">
                <div class="exp-fill" style="width: {{multiply (divide system.info.experience 2700) 100}}%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      {{!-- æ´¾ç”Ÿå±æ€§å¡ç‰‡ --}}
      <div class="derived-stats">
        <div class="stat-card hp">
          <div class="stat-header">
            <span class="stat-icon">â¤ï¸</span>
            <span class="stat-name">ç”Ÿå‘½å€¼</span>
          </div>
          <div class="stat-values">
            <input type="number" name="system.derived.hp.value" value="{{system.derived.hp.value}}" min="0"/>
            <span class="divider">/</span>
            <span class="stat-max">{{system.derived.hp.max}}</span>
          </div>
          <div class="stat-bar">
            <div class="bar-fill hp-fill" style="width: {{multiply (divide system.derived.hp.value system.derived.hp.max) 100}}%"></div>
          </div>
        </div>
        
        <div class="stat-card corruption">
          <div class="stat-header">
            <span class="stat-icon">ğŸ’€</span>
            <span class="stat-name">ä¾µèš€åº¦</span>
          </div>
          <div class="stat-values">
            <input type="number" name="system.derived.corruption.value" value="{{system.derived.corruption.value}}" min="0"/>
            <span class="divider">/</span>
            <span class="stat-max">{{system.derived.corruption.max}}</span>
          </div>
          <div class="stat-bar">
            <div class="bar-fill corruption-fill" style="width: {{multiply (divide system.derived.corruption.value system.derived.corruption.max) 100}}%"></div>
          </div>
        </div>
        
        <div class="stat-card starlight">
          <div class="stat-header">
            <span class="stat-icon">â­</span>
            <span class="stat-name">æ˜Ÿå…‰</span>
          </div>
          <div class="stat-values">
            <span class="stat-current">{{system.derived.starlight}}</span>
            <span class="divider">/</span>
            <span class="stat-max">{{add 10 (multiply system.level 2)}}</span>
          </div>
          <div class="stat-detail">å·²ç”¨: {{system.derived.starlightUsed}}</div>
        </div>
        
        <div class="mini-stats">
          <div class="mini-stat">
            <span class="mini-icon">âš¡</span>
            <span class="mini-label">æ··ä¹±æ¡</span>
            <span class="mini-value">{{system.derived.chaos}}</span>
          </div>
          <div class="mini-stat">
            <span class="mini-icon">ğŸƒ</span>
            <span class="mini-label">é€Ÿåº¦å€¼</span>
            <span class="mini-value">{{system.derived.speed}}</span>
          </div>
        </div>
      </div>
    </div>
    
    {{!-- å³ä¾§ï¼šå±æ€§å’Œèµ„æº --}}
    <div class="right-section">
      {{!-- å…­ç»´å±æ€§ --}}
      <div class="attributes-container">
        <h2 class="section-title">åŸºç¡€å±æ€§</h2>
        <div class="attributes-grid">
          <div class="attribute-card" data-attribute="strength">
            <div class="attribute-header">
              <div class="attribute-icon">STR</div>
              <div class="attribute-label">åŠ›é‡</div>
            </div>
            <div class="attribute-value-container">
              <input type="number" class="attribute-value" name="system.attributes.strength" value="{{system.attributes.strength}}" min="1" max="30"/>
              <div class="attribute-modifier">
                <span class="modifier-sign">{{#if (gt (floor (divide (subtract system.attributes.strength 10) 2)) -1)}}+{{/if}}</span>
                <span class="modifier-value">{{floor (divide (subtract system.attributes.strength 10) 2)}}</span>
              </div>
            </div>
            <button class="attribute-roll" data-attribute="strength" title="åŠ›é‡æ£€å®š">
              <i class="fas fa-dice-d20"></i>
            </button>
          </div>
          
          <div class="attribute-card" data-attribute="constitution">
            <div class="attribute-header">
              <div class="attribute-icon">CON</div>
              <div class="attribute-label">ä½“è´¨</div>
            </div>
            <div class="attribute-value-container">
              <input type="number" class="attribute-value" name="system.attributes.constitution" value="{{system.attributes.constitution}}" min="1" max="30"/>
              <div class="attribute-modifier">
                <span class="modifier-sign">{{#if (gt (floor (divide (subtract system.attributes.constitution 10) 2)) -1)}}+{{/if}}</span>
                <span class="modifier-value">{{floor (divide (subtract system.attributes.constitution 10) 2)}}</span>
              </div>
            </div>
            <button class="attribute-roll" data-attribute="constitution" title="ä½“è´¨æ£€å®š">
              <i class="fas fa-dice-d20"></i>
            </button>
          </div>
          
          <div class="attribute-card" data-attribute="dexterity">
            <div class="attribute-header">
              <div class="attribute-icon">DEX</div>
              <div class="attribute-label">æ•æ·</div>
            </div>
            <div class="attribute-value-container">
              <input type="number" class="attribute-value" name="system.attributes.dexterity" value="{{system.attributes.dexterity}}" min="1" max="30"/>
              <div class="attribute-modifier">
                <span class="modifier-sign">{{#if (gt (floor (divide (subtract system.attributes.dexterity 10) 2)) -1)}}+{{/if}}</span>
                <span class="modifier-value">{{floor (divide (subtract system.attributes.dexterity 10) 2)}}</span>
              </div>
            </div>
            <button class="attribute-roll" data-attribute="dexterity" title="æ•æ·æ£€å®š">
              <i class="fas fa-dice-d20"></i>
            </button>
          </div>
          
          <div class="attribute-card" data-attribute="perception">
            <div class="attribute-header">
              <div class="attribute-icon">WIS</div>
              <div class="attribute-label">æ„ŸçŸ¥</div>
            </div>
            <div class="attribute-value-container">
              <input type="number" class="attribute-value" name="system.attributes.perception" value="{{system.attributes.perception}}" min="1" max="30"/>
              <div class="attribute-modifier">
                <span class="modifier-sign">{{#if (gt (floor (divide (subtract system.attributes.perception 10) 2)) -1)}}+{{/if}}</span>
                <span class="modifier-value">{{floor (divide (subtract system.attributes.perception 10) 2)}}</span>
              </div>
            </div>
            <button class="attribute-roll" data-attribute="perception" title="æ„ŸçŸ¥æ£€å®š">
              <i class="fas fa-dice-d20"></i>
            </button>
          </div>
          
          <div class="attribute-card" data-attribute="intelligence">
            <div class="attribute-header">
              <div class="attribute-icon">INT</div>
              <div class="attribute-label">æ™ºåŠ›</div>
            </div>
            <div class="attribute-value-container">
              <input type="number" class="attribute-value" name="system.attributes.intelligence" value="{{system.attributes.intelligence}}" min="1" max="30"/>
              <div class="attribute-modifier">
                <span class="modifier-sign">{{#if (gt (floor (divide (subtract system.attributes.intelligence 10) 2)) -1)}}+{{/if}}</span>
                <span class="modifier-value">{{floor (divide (subtract system.attributes.intelligence 10) 2)}}</span>
              </div>
            </div>
            <button class="attribute-roll" data-attribute="intelligence" title="æ™ºåŠ›æ£€å®š">
              <i class="fas fa-dice-d20"></i>
            </button>
          </div>
          
          <div class="attribute-card" data-attribute="charisma">
            <div class="attribute-header">
              <div class="attribute-icon">CHA</div>
              <div class="attribute-label">é­…åŠ›</div>
            </div>
            <div class="attribute-value-container">
              <input type="number" class="attribute-value" name="system.attributes.charisma" value="{{system.attributes.charisma}}" min="1" max="30"/>
              <div class="attribute-modifier">
                <span class="modifier-sign">{{#if (gt (floor (divide (subtract system.attributes.charisma 10) 2)) -1)}}+{{/if}}</span>
                <span class="modifier-value">{{floor (divide (subtract system.attributes.charisma 10) 2)}}</span>
              </div>
            </div>
            <button class="attribute-roll" data-attribute="charisma" title="é­…åŠ›æ£€å®š">
              <i class="fas fa-dice-d20"></i>
            </button>
          </div>
        </div>
      </div>
      
      {{!-- èµ„æºé¢æ¿ --}}
      <div class="resources-container">
        <h2 class="section-title">èµ„æº</h2>
        <div class="resources-grid">
          <div class="resource-item">
            <span class="resource-icon">ğŸ’°</span>
            <span class="resource-label">è´§å¸</span>
            <input type="number" name="system.resources.currency" value="{{system.resources.currency}}" min="0"/>
          </div>
          <div class="resource-item">
            <span class="resource-icon">ğŸ²</span>
            <span class="resource-label">å¥‡é‡ç‚¹</span>
            <input type="number" name="system.resources.encounterPoints" value="{{system.resources.encounterPoints}}" min="0"/>
          </div>
          <div class="resource-item">
            <span class="resource-icon">âœ¨</span>
            <span class="resource-label">å¥‡è¿¹ç‚¹</span>
            <input type="number" name="system.resources.miraclePoints" value="{{system.resources.miraclePoints}}" min="0"/>
          </div>
          <div class="resource-item">
            <span class="resource-icon">ğŸ”®</span>
            <span class="resource-label">å¤åˆ¶æ ¸å¿ƒ</span>
            <input type="number" name="system.resources.replicaCore" value="{{system.resources.replicaCore}}" min="0"/>
          </div>
        </div>
      </div>
      
      {{!-- åŠ¨ä½œæŒ‰é’® --}}
      <div class="action-buttons">
        <button class="action-btn corruption-check">
          <i class="fas fa-skull"></i>
          <span>ä¾µèš€æ£€å®š</span>
        </button>
        <button class="action-btn long-rest">
          <i class="fas fa-bed"></i>
          <span>é•¿æœŸä¼‘æ¯</span>
        </button>
        <button class="action-btn roll-speed">
          <i class="fas fa-running"></i>
          <span>æŠ•æ·é€Ÿåº¦</span>
        </button>
      </div>
    </div>
  </div>

  {{!-- Sheet Tab Navigation --}}
  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item active" data-tab="skills">æŠ€èƒ½</a>
    <a class="item" data-tab="equipment">è£…å¤‡</a>
    <a class="item" data-tab="inventory">ç‰©å“æ </a>
    <a class="item" data-tab="biography">èƒŒæ™¯</a>
  </nav>

  {{!-- Sheet Body --}}
  <section class="sheet-body">
    {{!-- Skills Tab --}}
    <div class="tab skills active" data-group="primary" data-tab="skills">
      {{> "systems/shuhai-dalu/templates/actor/parts/actor-skills.hbs"}}
    </div>
    
    {{!-- Equipment Tab --}}
    <div class="tab equipment" data-group="primary" data-tab="equipment">
      {{> "systems/shuhai-dalu/templates/actor/parts/actor-equipment.hbs"}}
    </div>
    
    {{!-- Inventory Tab --}}
    <div class="tab inventory" data-group="primary" data-tab="inventory">
      {{> "systems/shuhai-dalu/templates/actor/parts/actor-inventory.hbs"}}
    </div>
    
    {{!-- Biography Tab --}}
    <div class="tab biography" data-group="primary" data-tab="biography">
      {{editor enrichedBiography target="system.biography" button=true owner=owner editable=editable}}
    </div>
  </section>
</form>
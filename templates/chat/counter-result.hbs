{{!-- å¯¹æŠ—ç»“æœèŠå¤©å¡ç‰‡ --}}
<div class="counter-result-card" style="background: #0F0D1B; border: 2px solid #EBBD68; border-radius: 8px; padding: 16px; color: #EBBD68; font-family: 'Noto Sans SC', sans-serif;">

  {{!-- æ ‡é¢˜ --}}
  <div class="result-header" style="text-align: center; padding: 8px 0; border-bottom: 1px solid #EBBD68; margin-bottom: 16px;">
    <h3 style="margin: 0; font-size: 18px; color: #E1AA43;">âš”ï¸ æ‹¼ç‚¹ç»“æœ</h3>
  </div>

  {{!-- å¯¹æŠ—åŒæ–¹å¯¹æ¯” --}}
  <div class="combatants-comparison" style="display: grid; grid-template-columns: 1fr auto 1fr; gap: 16px; margin-bottom: 16px; align-items: center;">

    {{!-- æŒ‘æˆ˜è€…ï¼ˆå‘èµ·è€…ï¼‰ --}}
    <div class="combatant initiator" style="background: rgba(235, 189, 104, 0.1); border: 1px solid #EBBD68; border-radius: 6px; padding: 12px;">
      <div style="text-align: center; font-size: 12px; color: #E1AA43; margin-bottom: 8px;">âš”ï¸ æŒ‘æˆ˜è€…</div>
      <div style="text-align: center; font-weight: bold; font-size: 16px; margin-bottom: 8px;">{{initiatorName}}</div>

      {{!-- æˆ˜æ–—éª°å¡ç‰‡ --}}
      <div style="position: relative; width: 60px; height: 60px; border: 1px solid #EBBD68; border-radius: 4px; margin: 0 auto 8px; background: transparent;">
        <img src="{{initiatorDiceImg}}" alt="{{initiatorDiceName}}" style="width: 100%; height: 100%; object-fit: contain; padding: 2px;" />
        <div style="position: absolute; top: -4px; left: -4px; width: 16px; height: 16px; background: #E1AA43; color: #0F0D1B; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold;">{{initiatorDiceCost}}</div>
        <div style="position: absolute; bottom: -4px; right: -4px; padding: 2px 4px; background: #E1AA43; color: #0F0D1B; border-radius: 3px; font-size: 10px; font-weight: bold;">{{initiatorDiceFormula}}</div>
      </div>

      <div style="font-size: 13px; text-align: center; margin-bottom: 4px;">{{initiatorDiceName}}</div>

      {{!-- è®¡ç®—è¯¦æƒ… --}}
      <div style="font-size: 12px; padding: 8px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; margin-bottom: 8px;">
        <div>éª°æ•°: <span style="color: #f3c267;">{{initiatorDiceRoll}}</span></div>
        <div>BUFF: <span style="color: #f3c267;">{{initiatorBuff}}</span></div>
        <div>è°ƒæ•´: <span style="color: #f3c267;">{{initiatorAdjustment}}</span></div>
      </div>

      {{!-- æœ€ç»ˆç»“æœ --}}
      <div style="text-align: center; font-size: 24px; font-weight: bold; color: {{#if initiatorWon}}#4a7c2c{{else}}#c14545{{/if}};">
        {{initiatorResult}}
      </div>
    </div>

    {{!-- VS åˆ†éš”ç¬¦ --}}
    <div style="font-size: 28px; font-weight: bold; color: #EBBD68; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
      VS
    </div>

    {{!-- å¯¹æŠ—è€… --}}
    <div class="combatant counter" style="background: rgba(235, 189, 104, 0.1); border: 1px solid #EBBD68; border-radius: 6px; padding: 12px;">
      <div style="text-align: center; font-size: 12px; color: #E1AA43; margin-bottom: 8px;">ğŸ›¡ï¸ å¯¹æŠ—è€…</div>
      <div style="text-align: center; font-weight: bold; font-size: 16px; margin-bottom: 8px;">{{counterName}}</div>

      {{!-- æˆ˜æ–—éª°å¡ç‰‡ --}}
      <div style="position: relative; width: 60px; height: 60px; border: 1px solid #EBBD68; border-radius: 4px; margin: 0 auto 8px; background: transparent;">
        <img src="{{counterDiceImg}}" alt="{{counterDiceName}}" style="width: 100%; height: 100%; object-fit: contain; padding: 2px;" />
        <div style="position: absolute; top: -4px; left: -4px; width: 16px; height: 16px; background: #E1AA43; color: #0F0D1B; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold;">{{counterDiceCost}}</div>
        <div style="position: absolute; bottom: -4px; right: -4px; padding: 2px 4px; background: #E1AA43; color: #0F0D1B; border-radius: 3px; font-size: 10px; font-weight: bold;">{{counterDiceFormula}}</div>
      </div>

      <div style="font-size: 13px; text-align: center; margin-bottom: 4px;">{{counterDiceName}}</div>

      {{!-- è®¡ç®—è¯¦æƒ… --}}
      <div style="font-size: 12px; padding: 8px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; margin-bottom: 8px;">
        <div>éª°æ•°: <span style="color: #f3c267;">{{counterDiceRoll}}</span></div>
        <div>BUFF: <span style="color: #f3c267;">{{counterBuff}}</span></div>
        <div>è°ƒæ•´: <span style="color: #f3c267;">{{counterAdjustment}}</span></div>
      </div>

      {{!-- æœ€ç»ˆç»“æœ --}}
      <div style="text-align: center; font-size: 24px; font-weight: bold; color: {{#if initiatorWon}}#c14545{{else}}#4a7c2c{{/if}};">
        {{counterResult}}
      </div>
    </div>

  </div>

  {{!-- å¯¹æŠ—ç»“æœæè¿° --}}
  <div class="result-description" style="padding: 12px; background: rgba(235, 189, 104, 0.15); border-radius: 6px; margin-bottom: 16px; text-align: center;">
    {{{resultDescription}}}
  </div>

  {{!-- ç»“ç®—ä¼¤å®³æŒ‰é’® --}}
  <div style="text-align: center;">
    <button class="settle-damage-btn"
            data-loser-id="{{loserId}}"
            data-final-damage="{{finalDamage}}"
            style="padding: 12px 32px; background: #c14545; color: #FFFFFF; border: none; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">
      ğŸ’¥ ç»“ç®—ä¼¤å®³
    </button>
  </div>

</div>

<style>
.counter-result-card .settle-damage-btn:hover {
  background: #d94545;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.4);
}

.counter-result-card .settle-damage-btn:disabled {
  background: #888;
  cursor: not-allowed;
  transform: none;
  opacity: 0.6;
}
</style>
